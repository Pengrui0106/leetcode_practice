#1667. Fix Names in a Table

#NOTE: CONCAT means join together; SUBSTR means choose a part of the string.
SELECT user_id, 
    CONCAT(
        UPPER(LEFT(name,1)),
        LOWER(SUBSTRING(name,2))
    ) AS name
FROM Users
ORDER BY user_id
;

#1527. Patients With a Condition

SELECT *
FROM Patients
WHERE conditions LIKE 'DIAB1%' OR conditions LIKE '% DIAB1%'
;


#196. Delete Duplicate Emails

WITH ranked AS(
    SELECT *,
    ROW_NUMBER() OVER(PARTITION BY email ORDER BY id) AS rn
    FROM Person
)

DELETE FROM Person
WHERE id IN(
    SELECT id FROM ranked WHERE rn > 1
)
;




#176. Second Highest Salary

#NOTE: OFFSET * means skip how many rows.

SELECT(
    SELECT DISTINCT salary
    FROM Employee
    ORDER BY salary DESC
    LIMIT 1 OFFSET 1
) AS SecondHighestSalary
;



#1484. Group Sold Products By The Date

#NOTE: GROUP_CONCAT can form a group of strings together.

SELECT 
    sell_date,
    COUNT(DISTINCT product) AS num_sold,
    GROUP_CONCAT(
        DISTINCT product
        ORDER BY product ASC
        SEPARATOR ','
    ) AS products
FROM Activities
GROUP BY sell_date
ORDER BY sell_date
;



#327. List the Products Ordered in a Period

SELECT 
    p.product_name,
    SUM(o.unit) AS unit
FROM Products p
JOIN Orders o
    ON p.product_id = o.product_id
WHERE YEAR(o.order_date) = 2020 AND MONTH(o.order_date) = 2
GROUP BY p.product_id
HAVING SUM(o.unit) >= 100
;



#1517. Find Users With Valid E-Mails

#NOTE: String functions REGEXP. 'c' means case-sensitive.

SELECT *
FROM Users
WHERE REGEXP_LIKE(
    mail, '^[a-zA-Z][0-9a-zA-Z._-]*@leetcode\\.com$', 'c'
)  
;
